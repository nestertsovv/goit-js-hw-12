{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export const refs = {\n  formSearch: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nimport { refs } from './refs';\n\nexport async function getImages(query, page) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const PARAMS = {\n    params: {\n      key: '43999869-2222e4e6c4d0611e5b13cb64c',\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: 15,\n    },\n  };\n\n  showLoader();\n\n  return axios\n    .get(BASE_URL, PARAMS)\n    .then(response => {\n      const { data } = response;\n\n      if (!data.hits.length) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n        });\n      }\n\n      return data;\n    })\n    .catch(error => {\n      iziToast.error({\n        message: `${error}`,\n        position: 'topRight',\n      });\n    })\n    .finally(() => {\n      hideLoader();\n    });\n}\n\nexport function showLoader() {\n  refs.loader.style.display = 'block';\n}\n\nexport function hideLoader() {\n  refs.loader.style.display = 'none';\n}\n","export function createTemplate(query) {\n  let imagesArr = '';\n  console.log('RENDER');\n\n  query.map(elem => {\n    const {\n      webformatURL,\n      largeImageURL,\n      tags,\n      views,\n      downloads,\n      likes,\n      comments,\n    } = elem;\n\n    imagesArr += `<div class=\"item-gallery\">\n                <a href=\"${largeImageURL}\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\">\n                </a>\n                <div class=\"item-info\">\n                    <div class=\"item-info-content\">\n                        <p>Likes</p>\n                        <p>${likes}</p>\n                    </div>\n                    <div class=\"item-info-content\">\n                        <p>Views</p>\n                        <p>${views}</p>\n                    </div>\n                    <div class=\"item-info-content\">\n                        <p>Comments</p>\n                        <p>${comments}</p>\n                    </div>\n                    <div class=\"item-info-content\">\n                        <p>Downloads</p>\n                        <p>${downloads}</p>\n                    </div>\n                </div>\n            </div>`;\n  });\n\n  return imagesArr;\n}\n","import simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImages } from './js/pixabay-api';\nimport { createTemplate } from './js/render-functions';\nimport { showLoader, hideLoader } from './js/pixabay-api';\nimport { refs } from './js/refs';\n\nconst optionsModal = {\n  captionsData: 'alt',\n  captionDelay: 250,\n  className: 'js-backdrop',\n};\nconst lightbox = new simpleLightbox('.gallery a', optionsModal);\n\nlet searchValue = null;\nlet page = 1;\nconst limit = 15;\n\nrefs.formSearch.addEventListener('submit', onSubmit);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSubmit(e) {\n  e.preventDefault();\n\n  page = 1;\n  searchValue = e.target.elements.search.value.trim();\n\n  if (!searchValue) return;\n\n  refs.gallery.innerHTML = '';\n\n  try {\n    const response = await getImages(searchValue, page);\n    const { hits: data, totalHits: total } = response;\n\n    total > limit ? showMoreBtn() : hideMoreBtn();\n\n    renderTemplate(data);\n    lightbox.refresh();\n  } catch (error) {\n    iziToast.error({\n      message: `${error}`,\n      position: 'topRight',\n    });\n  } finally {\n    e.target.reset();\n  }\n}\n\nasync function onLoadMore() {\n  page++;\n\n  showLoader();\n\n  const galleryItem = document.querySelector('.item-gallery');\n  const heightItem = galleryItem.getBoundingClientRect().height;\n\n  try {\n    const response = await getImages(searchValue, page);\n    const { hits: data, totalHits: total } = response;\n    const lastPage = Math.ceil(total / limit);\n\n    if (lastPage === page) {\n      hideMoreBtn();\n\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n\n    refs.gallery.insertAdjacentHTML('beforeend', createTemplate(data));\n    lightbox.refresh();\n  } catch (error) {\n    iziToast.error({\n      message: `${error}`,\n      position: 'topRight',\n    });\n  } finally {\n    setTimeout(() => {\n      window.scrollBy(0, heightItem * 2 + 48);\n    }, 400);\n\n    hideLoader();\n  }\n}\n\nfunction renderTemplate(query) {\n  const markup = createTemplate(query);\n\n  refs.gallery.insertAdjacentHTML('afterbegin', markup);\n}\n\nfunction showMoreBtn() {\n  refs.loadMoreBtn.classList.remove('is-hidden');\n}\n\nfunction hideMoreBtn() {\n  refs.loadMoreBtn.classList.add('is-hidden');\n}\n"],"names":["refs","getImages","query","page","BASE_URL","PARAMS","showLoader","axios","response","data","iziToast","error","hideLoader","createTemplate","imagesArr","elem","webformatURL","largeImageURL","tags","views","downloads","likes","comments","optionsModal","lightbox","simpleLightbox","searchValue","limit","onSubmit","onLoadMore","e","total","showMoreBtn","hideMoreBtn","renderTemplate","heightItem","markup"],"mappings":"owBAAO,MAAMA,EAAO,CAClB,WAAY,SAAS,cAAc,cAAc,EACjD,QAAS,SAAS,cAAc,UAAU,EAC1C,OAAQ,SAAS,cAAc,SAAS,EACxC,YAAa,SAAS,cAAc,gBAAgB,CACtD,ECAO,eAAeC,EAAUC,EAAOC,EAAM,CAC3C,MAAMC,EAAW,2BACXC,EAAS,CACb,OAAQ,CACN,IAAK,qCACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAU,EACX,CACL,EAEE,OAAAG,IAEOC,EACJ,IAAIH,EAAUC,CAAM,EACpB,KAAKG,GAAY,CAChB,KAAM,CAAE,KAAAC,CAAM,EAAGD,EAEjB,OAAKC,EAAK,KAAK,QACbC,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UACpB,CAAS,EAGID,CACb,CAAK,EACA,MAAME,GAAS,CACdD,EAAS,MAAM,CACb,QAAS,GAAGC,CAAK,GACjB,SAAU,UAClB,CAAO,CACP,CAAK,EACA,QAAQ,IAAM,CACbC,GACN,CAAK,CACL,CAEO,SAASN,GAAa,CAC3BN,EAAK,OAAO,MAAM,QAAU,OAC9B,CAEO,SAASY,GAAa,CAC3BZ,EAAK,OAAO,MAAM,QAAU,MAC9B,CCrDO,SAASa,EAAeX,EAAO,CACpC,IAAIY,EAAY,GAChB,eAAQ,IAAI,QAAQ,EAEpBZ,EAAM,IAAIa,GAAQ,CAChB,KAAM,CACJ,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,UAAAC,EACA,MAAAC,EACA,SAAAC,CACD,EAAGP,EAEJD,GAAa;AAAA,2BACUG,CAAa;AAAA,gCACRD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,6BAK7BG,CAAK;AAAA;AAAA;AAAA;AAAA,6BAILF,CAAK;AAAA;AAAA;AAAA;AAAA,6BAILG,CAAQ;AAAA;AAAA;AAAA;AAAA,6BAIRF,CAAS;AAAA;AAAA;AAAA,mBAItC,CAAG,EAEMN,CACT,CChCA,MAAMS,EAAe,CACnB,aAAc,MACd,aAAc,IACd,UAAW,aACb,EACMC,EAAW,IAAIC,EAAe,aAAcF,CAAY,EAE9D,IAAIG,EAAc,KACdvB,EAAO,EACX,MAAMwB,EAAQ,GAEd3B,EAAK,WAAW,iBAAiB,SAAU4B,CAAQ,EACnD5B,EAAK,YAAY,iBAAiB,QAAS6B,CAAU,EAErD,eAAeD,EAASE,EAAG,CAMzB,GALAA,EAAE,eAAc,EAEhB3B,EAAO,EACPuB,EAAcI,EAAE,OAAO,SAAS,OAAO,MAAM,OAEzC,EAACJ,EAEL,CAAA1B,EAAK,QAAQ,UAAY,GAEzB,GAAI,CACF,MAAMQ,EAAW,MAAMP,EAAUyB,EAAavB,CAAI,EAC5C,CAAE,KAAMM,EAAM,UAAWsB,CAAK,EAAKvB,EAEzCuB,EAAQJ,EAAQK,EAAa,EAAGC,EAAW,EAE3CC,EAAezB,CAAI,EACnBe,EAAS,QAAO,CACjB,OAAQb,EAAO,CACdD,EAAS,MAAM,CACb,QAAS,GAAGC,CAAK,GACjB,SAAU,UAChB,CAAK,CACL,QAAY,CACRmB,EAAE,OAAO,OACV,EACH,CAEA,eAAeD,GAAa,CAC1B1B,IAEAG,IAGA,MAAM6B,EADc,SAAS,cAAc,eAAe,EAC3B,sBAAqB,EAAG,OAEvD,GAAI,CACF,MAAM3B,EAAW,MAAMP,EAAUyB,EAAavB,CAAI,EAC5C,CAAE,KAAMM,EAAM,UAAWsB,CAAK,EAAKvB,EACxB,KAAK,KAAKuB,EAAQJ,CAAK,IAEvBxB,IACf8B,IAEAvB,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAClB,CAAO,GAGHV,EAAK,QAAQ,mBAAmB,YAAaa,EAAeJ,CAAI,CAAC,EACjEe,EAAS,QAAO,CACjB,OAAQb,EAAO,CACdD,EAAS,MAAM,CACb,QAAS,GAAGC,CAAK,GACjB,SAAU,UAChB,CAAK,CACL,QAAY,CACR,WAAW,IAAM,CACf,OAAO,SAAS,EAAGwB,EAAa,EAAI,EAAE,CACvC,EAAE,GAAG,EAENvB,GACD,CACH,CAEA,SAASsB,EAAehC,EAAO,CAC7B,MAAMkC,EAASvB,EAAeX,CAAK,EAEnCF,EAAK,QAAQ,mBAAmB,aAAcoC,CAAM,CACtD,CAEA,SAASJ,GAAc,CACrBhC,EAAK,YAAY,UAAU,OAAO,WAAW,CAC/C,CAEA,SAASiC,GAAc,CACrBjC,EAAK,YAAY,UAAU,IAAI,WAAW,CAC5C"}